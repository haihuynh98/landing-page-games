var _isMultiTouch=1<navigator.maxTouchPoints,winW=window.innerWidth||$(window).width(),flag=!1,sliderIndex=0,swiperSpeed=300,popCheck=!1,$body=$("body");function scrollEvent(){var e=null,t=$(window);t.on("scroll",function(){e=e||setTimeout(function(){e=null,addCurrentClass(),getSectionId(),activeSnsTop(t.scrollTop()),animationActive()},150)})}function resizeEvent(){var e=null;$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){animationActive(),(1024<$(window).outerWidth()||!1===_isMultiTouch)&&($("html, body").stop().animate({scrollTop:$(".currentView").offset().top},250),setBgImgPosition())},150)})}function activeSnsTop(e){50<e?$(".js-snsTop").addClass("active"):$(".js-snsTop").removeClass("active")}function popupGallery(){var t=$("#galleryPopup"),o=$(".galleryPop"),e=($("video").get(0),!1),i=$(".popup_layer"),n=($(".preview_box").on("click",function(){n();var e=$(this).parent("li").data("slider");t.fadeIn(200),$(".gallery").removeClass("on"),i.fadeIn(200),popCheck=!0,o.trigger("to.owl.carousel",[e,0]),$body.addClass("overHidden")}),$("#galleryPopup .btn_popup_close").on("click",function(e){t.fadeOut(200),i.fadeOut(200),$(".gallery").addClass("on"),popCheck=!1,$body.removeClass("overHidden")}),o.owlCarousel({items:1,nav:!0,dots:!0,dotsData:!0,loop:!0}),function(){1!=e&&($("img.lazyPop").each(function(){var e=$(this),t=e.data("pop");$("body").hasClass("ko")?e.attr("src",t+"_thumb_ko.jpg?v=2"):e.attr("src",t+"_thumb_en.jpg?v=2"),$("body").hasClass("ko")?e.attr("data-originalimage",t+"_ko.jpg?v=2"):e.attr("data-originalimage",t+"_en.jpg?v=2")}),e=!0)});$(".js-galleryDown").on("click",function(){var t=$(".galleryPop").find(".owl-item.active"),e=t.find("img").data("originalimage")||function(){{var e;e=(1==$("body").hasClass("ko")?t.find("video.only_ko"):t.find("video.only_en")).attr("poster")}return e}();$(this).prop("href",e)}),$(document).on("keydown",function(e){37!=e.keyCode&&39!=e.keyCode||t.is(":visible")&&(37==e.keyCode?$(".owl-prev").trigger("click"):39==e.keyCode&&$(".owl-next").trigger("click"))})}function isMobile(e){return winW<=(e=null==e?1024:e)}function isTouchScreen(){return 0<navigator.maxTouchPoints&&256!==navigator.maxTouchPoints}$(function(){dateInit(),register(),gallerySlider(),popupGallery(),CookiePopup(),animationActive(),scrollCtrl(),streamInit(),mediaInit(),scrollEvent(),resizeEvent(),bgPositionChange(),asideFunc($(".js-mobileMenuOpen"),"#js-leftProfileAcitve")});var gallerySlide=void 0,$previewNav=$(".js-previewNav"),$previewCurrent=$previewNav.find(".js-current"),$previewLength=$previewNav.find(".js-length");function counter(e){var t;e.currentTarget.classList.contains("js-previewOwl")&&((t=e.page.count)<(e=(e.page.index||0)+1)&&(e=itemIdx-t),$previewCurrent.text(e),$previewLength.text(t))}function gallerySlider(){function e(){(window.innerWidth||$(window).width())<768?(t.addClass("owl-carousel"),t.owlCarousel(o),null!=gallerySlide&&gallerySlide.destroy()):("undefined"!==t.data("owlCarousel")&&(t.trigger("destroy.owl.carousel"),t.removeClass("owl-carousel owl-loaded owl-drag")),null!=gallerySlide&&1!=gallerySlide.destroyed||(gallerySlide=new Swiper(".gallery.swiper-container",{speed:swiperSpeed,allowTouchMove:!0,freeMode:!1,centeredSlides:!0,breakpoints:{767:{allowTouchMove:!1}},loop:!1,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},preloadImages:!1,lazy:{loadPrevNext:!0},on:{lazyImageReady:function(e){e=$(e);0===e.find(".swiper-lazy").not(".swiper-lazy-loaded").length&&e.addClass("loaded")}}})))}var r=!0,t=$(".js-previewOwl"),o={items:1,nav:!1,dots:!0,dotsData:!0,loop:!0,autoHeight:!1,stagePadding:30,margin:30,lazyLoad:!0,onLoadedLazy:function(e){counter(e)},onTranslate:function(e){counter(e)}};e(),$(".js-previewPrev").on("click",function(){t.trigger("prev.owl.carousel")}),$(".js-previewNext").on("click",function(){t.trigger("next.owl.carousel")}),$(window).on("resize",function(){e()}),$(".js-tabCtrl").on("keydown",function(e){var t,o,i,n,s,a;window.innerWidth<768||(t=$(this),9===e.keyCode&&(o=t.parents(".swiper-slide").index(),e.shiftKey&&t.hasClass("js-firstSlider")?(e.preventDefault(),--o,n=$($(".swiper-slide")[o]),s=$($(".swiper-pagination-bullet")[o]),i=n.find(".js-tabCtrl").last(),s.trigger("click"),!0===r&&(r=!1,setTimeout(function(){i.focus(),r=!0},swiperSpeed))):!1===e.shiftKey&&t.hasClass("js-lastSlider")&&(e.preventDefault(),o+=1,n=$($(".swiper-slide")[o]),s=$($(".swiper-pagination-bullet")[o]),a=n.find(".js-tabCtrl").first(),s.trigger("click"),!0===r)&&(r=!1,setTimeout(function(){a.focus(),r=!0},swiperSpeed))))}),$(".preview_box").on("focus",function(){var e=$(this).parents(".swiper-slide").index();e!==$(".swiper-pagination-bullet-active").index()&&$($(".swiper-pagination-bullet")[e]).trigger("click")}),$(".gallery").on("keydown",".swiper-pagination-bullet:first",function(e){9===e.keyCode&&0!=e.shiftKey&&(e.preventDefault(),e=$(".swiper-pagination-bullet-active").index(),$($(".swiper-pagination-bullet")[e]).trigger("click"),$($(".swiper-slide")[e]).find(".js-lastSlider").focus())})}function resizeVideo(e,t,o,i){var n=$(window),s=n.height()*i,n=n.width()*i,i=n/t<s/o?n/t:s/o,n=t*i,s=o*i;if(!(0<e.length))return{width:parseInt(n),height:parseInt(s)};e.css({width:parseInt(n),height:parseInt(s)})}function CookiePopup(){if("allow"==getCookie("analyticsPopup"))return!1;$(".cookieAlert").addClass("active"),$(".cookieAllow").on("click",function(){addCookie("analyticsPopup","allow",364,_cookieDomain),$(".js-cookieAlert").removeClass("active")})}var scrollCtrl=function(){var t=!0,o=($(".main-wrapper").on("mousewheel",function(e){_isMultiTouch||$(window).outerWidth()<1025||$(window).outerHeight()<800||(e.preventDefault(),!1!==t&&!0===t&&(t=!1,(0<e.originalEvent.wheelDelta?i:o)(),setTimeout(function(){t=!0},600)))}),$(".pages").on("focus",'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]',function(){window.innerWidth<1025||!0===$(this).parents(".pages").hasClass("currentView")||($(".pages").removeClass("currentView"),$(this).parents(".pages").addClass("currentView"),$("html, body").stop().animate({scrollTop:$(".currentView").offset().top},400))}),$(".js-arrowDown").on("click",function(){o()}),$(".js-goingTeaser").on("click",function(){var e=$(".page_2").offset().top;$("html, body").stop().animate({scrollTop:e},400),$(".js-movieWrap").addClass("nextPage"),$(".js-trailerTeaser").trigger("click")}),$(".js-btnNews").on("click",function(){var e=$(".page_5").offset().top;$("html, body").stop().animate({scrollTop:e},400)}),function(){var e=$(".currentView");$(".page_2").hasClass("currentView")&&!$(".js-movieWrap").hasClass("nextPage")?$(".js-movieWrapPagerBtn").eq(0).trigger("click"):0!==(e=e.next(".pages")).length&&(e=e.offset().top,$("html, body").stop().animate({scrollTop:e},400))}),i=function(){var e=$(".currentView");$(".page_2").hasClass("currentView")&&$(".js-movieWrap").hasClass("nextPage")?$(".js-movieWrapPagerBtn").eq(0).trigger("click"):0!==(e=e.prev(".pages")).length&&(e=e.offset().top,$("html, body").stop().animate({scrollTop:e},400))};addCurrentClass()},addCurrentClass=function(){$(".pages").each(function(e,t){var t=$(t),o=t.offset().top,i=t.outerHeight(),n=$(window).scrollTop();o-.3*i<=n&&n<o+.7*i?t.addClass("currentView"):t.removeClass("currentView")})},setBgImgPosition=function(){var e,t=document.querySelector(".main-bg"),o=t.querySelector("img");document.querySelector(".page_5 .js-scrollAnimate").classList.contains("active")?(e=1.125*t.offsetWidth,o.style.transform="translate3d(0, "+(t.offsetHeight-e)+"px, 0)",$(".sns_top").addClass("on")):(o.style.transform="translate3d(0, 0px, 0)",$(".sns_top").removeClass("on"))},bgPositionChange=function(){var e=document.querySelector(".page_5 .js-scrollAnimate");setBgImgPosition();new MutationObserver(function(e,t){e.forEach(function(e){"attributes"===e.type&&"class"===e.attributeName&&setBgImgPosition()})}).observe(e,{attributes:!0})},activeToggler=function(e){var t=$(window).scrollTop()+$(window).innerHeight();e.offset().top+.3*e.outerHeight()<t?e.addClass("active"):e.removeClass("active")},animationActive=function(){$(".js-scrollAnimate").each(function(e,t){t=$(t);activeToggler(t)})},streamingInit=function(){function o(e){for(var t=0,t=e?0:-1,o=0;o<$(".streaming_link").length;o++){var i=$($(".streaming_link")[o]);i.hasClass("comingsoon")||i.attr("tabindex",t)}}$(".js-streamingOpener").on("click keydown",function(e){!1!=("click"==e.type||"mouseenter"==e.type||13==e.keyCode)&&($(this).toggleClass("active"),o(!0),$(".streaming_link").first().focus())}),$(".js-streamingOpener").on("mouseenter mouseleave",function(e){var t=!0;"mouseenter"==e.type&&!1===isMobile()?$(this).addClass("active"):"mouseleave"==e.type&&(t=!1,$(this).removeClass("active")),o(t)}),$(".streaming_link").on("click",function(e){if(!0===$(this).hasClass("comingsoon"))return e.stopPropagation(),e=($(this).attr("title")||$(this).data("tipText")).replace("<br>"," "),alert(e),!1}),$(".streaming_link").on({mouseenter:tooltipBox,mouseleave:tooltipBox,mousemove:tooltipBox})};function tooltipBox(e){var t,o,i,n;$(window).outerWidth()<1025||(o=(t=$(this)).attr("title"),i=e.type,n=+e.clientX,e=e.clientY-7,"mouseenter"==i?(t.data("tipText",o).removeAttr("title"),$("body").append('<span class="streaming_txt"><span class="streaming_inner">'+o+"</span></span>").fadeIn(250),$(".streaming_txt").css("top",e+"px").css("left",n+"px")):"mouseleave"==i?(t.attr("title",t.data("tipText")),$(".streaming_txt").fadeOut().remove()):"mousemove"==i&&$(".streaming_txt").css("top",e+"px").css("left",n+"px"))}var streamInit=function(){function i(e){e=e||500,s.addClass("over"),t.css("max-height",e),t.stop().slideDown(250)}function n(){s.removeClass("over"),t.stop().slideUp(250,function(){t.css("height",0).attr("style","")})}var e,s=$(".js-streamWrap"),t=s.find(".js-streamList"),a=s.parents(".pages").next(".pages"),r=t.outerHeight();$(window).on("resize",function(){e=e||setTimeout(function(){e=null,r=t.outerHeight()},200)}),s.on("mouseover mouseleave click",function(e){var t=s.outerHeight(),t=a.offset().top-(s.offset().top+r+t)-15,o=t<0?r+t:r;!1===isTouchScreen()?"mouseover"==e.type?(t<0&&$body.css("overflow-y","hidden"),i(o)):"mouseleave"==e.type&&("hidden"==$body.css("overflow-y")&&$body.css("overflow-y","overlay"),n()):"click"==e.type&&(e.stopPropagation(),s.hasClass("over")?n():i(o))}),$(".pages").on("click",function(){n()}),t.on("mouseover mousewheel",function(e){e.stopPropagation()})},mediaInit=function(){var e=$(".js-movieWrap");e.find(".js-movieWrapPagerBtn").on("click",function(){e.hasClass("nextPage")?(e.removeClass("nextPage"),history.pushState(null,null,"#musicvideo")):(e.addClass("nextPage"),history.pushState(null,null,"#trailer"))}),$(window).resize(function(){resizeVideo($("#Movie .content"),960,540,.75)})},getSectionId=function(){var e;window.innerWidth<1025?history.pushState(null,null," "):(e="#"+$(".currentView").attr("id"),$(".js-movieWrap").hasClass("nextPage")&&$(".page_2").hasClass("currentView")?history.pushState(null,null,"#trailer"):history.pushState(null,null,e))},reloadScroll=function(){var e;$(window).outerWidth()<1025?"manual"==history.scrollRestoration&&(history.scrollRestoration="auto"):(history.scrollRestoration="manual",void 0!==location.hash.split("#")[1]&&("trailer"===(e=location.hash.split("#")[1])?($(window).scrollTop($("#musicvideo").offset().top),$(".js-movieWrap").addClass("nextPage")):("musicvideo"===e&&($(window).scrollTop($("#musicvideo").offset().top),$(".js-movieWrap").removeClass("nextPage")),$("#"+e).length<=0||(e=$("#"+e).offset().top,$(window).scrollTop(e)))))},asideFunc=function(e,t){var o=$(".header_mobile").find(".dimm_sub_menu"),i=$("body"),n=$(t);e.on("click",function(e){e.stopPropagation(),$(this).hasClass("active")?(i.removeClass("hidden"),$(this).removeClass("active"),n.removeClass("active")):(i.addClass("hidden"),$(this).addClass("active"),n.addClass("active"),o.stop().fadeIn(250))}),$(".js-navClose").on("click",function(){i.removeClass("hidden"),e.removeClass("active"),n.removeClass("active"),o.hide()}),o.on("click",function(){$(".js-navClose").trigger("click")})};window.onhashchange=function(){reloadScroll()},reloadScroll();